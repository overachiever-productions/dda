
CREATE OR ALTER PROCEDURE [projection].[test endtx_without_starttx_throws]
AS
BEGIN
  	-----------------------------------------------------------------------------------------------------------------
	-- Arrange:
	-----------------------------------------------------------------------------------------------------------------
	EXEC [tSQLt].[ExpectException]
		@ExpectedMessagePattern = N'%@EndTransactionID can only be used when @StartTransactionID has been specified%';	

	-----------------------------------------------------------------------------------------------------------------
	-- Act: 
	-----------------------------------------------------------------------------------------------------------------
	EXEC dda.[get_audit_data]
		@StartTime = '2020-12-10 12:34:45', 
		@EndTransactionID = N'2021-028-034869927';

	-----------------------------------------------------------------------------------------------------------------
	-- Assert: 
	-----------------------------------------------------------------------------------------------------------------

END;